{"code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=229)}({13:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.DATA_DIR=\"data/\",t.INDEX_JSON=t.DATA_DIR+\"index.json\",t.CACHE_NAME_ENGINE=\"spacerangers-engine\",t.CACHE_NAME_IMAGES=\"spacerangers-images\",t.CACHE_NAME_MUSIC=\"spacerangers-music\"},229:function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function c(e){try{i(r.next(e))}catch(e){a(e)}}function s(e){try{i(r.throw(e))}catch(e){a(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(c,s)}i((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;c;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this;Object.defineProperty(t,\"__esModule\",{value:!0}),n(230);serviceWorkerOption.assets;var c=n(13),s=[\"/\",c.INDEX_JSON].concat(serviceWorkerOption.assets,[\"/?version=\"+new Date(\"2018-07-31T12:55:28.184Z\").getTime()]);function i(){return fetch(c.INDEX_JSON).then(function(e){return e.json()})}self.addEventListener(\"install\",function(e){console.info(new Date+\" Serviceworker got install event.\"),e.waitUntil(r(a,void 0,void 0,function(){var e,t,n,r,a,u;return o(this,function(o){switch(o.label){case 0:return[4,caches.open(c.CACHE_NAME_ENGINE)];case 1:return e=o.sent(),console.info(new Date+\" Serviceworker opened cache\"),[4,i()];case 2:t=o.sent(),n=0,r=[t.dir.quests],o.label=3;case 3:return n<r.length?(a=r[n],u=s.concat.apply(s,a.files.map(function(e){return e.path}).map(function(e){return c.DATA_DIR+e})),console.info(new Date+\" Starting to fill cache size=\"+a.totalSize),[4,e.addAll(u)]):[3,6];case 4:o.sent(),o.label=5;case 5:return n++,[3,3];case 6:return console.info(new Date+\" Catching done\"),[2]}})}).catch(function(e){throw console.error(new Date+\" Error in sw\",e),e}))}),self.addEventListener(\"activate\",function(e){console.log(new Date+\" ServiceWorker activation started\"),e.waitUntil(r(a,void 0,void 0,function(){var e,t,n;return o(this,function(r){switch(r.label){case 0:return[4,caches.keys()];case 1:return r.sent().map(function(e){console.info(\"Have cache key:\",e)}),[4,caches.open(c.CACHE_NAME_ENGINE)];case 2:return[4,r.sent().keys()];case 3:return e=r.sent(),[4,i()];case 4:for(r.sent(),t=0,n=e;t<n.length;t++)n[t];return console.info(new Date+\" Service worker activation finished\"),[2]}})}))}),self.addEventListener(\"fetch\",function(e){e.respondWith(r(a,void 0,void 0,function(){var t,n,r,a,s,i,u;return o(this,function(o){switch(o.label){case 0:return[4,caches.open(c.CACHE_NAME_ENGINE).then(function(t){return t.match(e.request.url)})];case 1:return(r=o.sent())?[3,3]:[4,caches.open(c.CACHE_NAME_IMAGES).then(function(t){return t.match(e.request.url)})];case 2:r=o.sent(),o.label=3;case 3:return(n=r)?[3,5]:[4,caches.open(c.CACHE_NAME_MUSIC).then(function(t){return t.match(e.request.url)})];case 4:n=o.sent(),o.label=5;case 5:return t=n,(a=e.request.headers.get(\"range\"))?(console.info(\"headersRange='\"+a+\"'\"),(s=a.match(/^bytes\\=(\\d+)\\-$/))?(i=parseInt(s[1]),console.log(\"Range request for\",e.request.url,\", starting position:\",i),t?[3,6]:(console.info(\"No audio cache for \"+e.request.url),[2,fetch(e.request)])):[2,fetch(e.request)]):[3,8];case 6:return console.info(\"Cache audio hit for \"+e.request.url),[4,t.arrayBuffer()];case 7:return u=o.sent(),[2,new Response(u.slice(i),{status:206,statusText:\"Partial Content\",headers:[[\"Content-Range\",\"bytes \"+i+\"-\"+(u.byteLength-1)+\"/\"+u.byteLength]]})];case 8:return t?(console.info(\"Cache hit for \"+e.request.url),[2,t]):(console.info(\"No cache for \"+e.request.url),[2,fetch(e.request)])}})}))})},230:function(e,t,n){\"use strict\"}});","extractedComments":[]}